$(function(){var e=_hfConfig.ApiPath,t="//s1.hfcdn.com",n=window.HF.messages,r="side-fixed",i="side-fixed-bottom",s="is-on",o="is-curr",u="is-active",a="is-show",f="is-hide",l="is-error",c="is-disable",h="lazy-loading",p="m-paging-lazy",d="m-paging-empty",v={addHouse:"isBuyDetailAddHouse",notifyLowerPrice:"isBuyDetailLowerPrice",addBuilding:"isBuyDetailAddBuilding",notifyBuildingNewCase:"isBuyDetailBuildingNewCase"},m="hfid-",g={current:t+"/fp/hf/img/buy/markers/ico_current.png",traffic:t+"/fp/hf/img/buy/markers/ico_traffic.png",life:t+"/fp/hf/img/buy/markers/ico_life.png",hospital:t+"/fp/hf/img/buy/markers/ico_hospital.png",education:t+"/fp/hf/img/buy/markers/ico_education.png",leisure:t+"/fp/hf/img/buy/markers/ico_leisure.png",hate:t+"/fp/hf/img/buy/markers/ico_hate.png"},y=$("#side"),b=y.parent(),w=y.find(".side-section"),E=$("#agent-section"),S=$("#map-section"),x=$("#house-list-section"),T=$("#reservation-form"),N=$("#reservation-form-loading"),C=navigator.userAgent.match(/msie 8.0/i)?!0:!1,k=window.HF.tools,L=0,A=0,O="",M=0,_=0,D={},P=!1,H,B,j={},F,I,q,R,U,z,W,X,V,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt,wt,Et,St,xt,Tt,Nt,Ct,kt,Lt,At,Ot,Mt,_t,Dt,Pt,Ht,Bt,jt;q=function(e){var t=(new Date).getTime(),n=window.location.href,r=n.indexOf("?")!==-1?n+"&v="+t:n+"?v="+t;window.open("http://www.facebook.com/share.php?u="+encodeURIComponent(r),"_blank","width=600,height=400"),e.preventDefault()},R=function(e){var t=$(this);t.CiRoBox({backdropclose:!0,click:!1,height:700,width:620,url:t.attr("href")}),e.preventDefault()},U=function(e){var t=$(this);t.CiRoBox({backdropclose:!0,click:!1,height:600,width:620,url:t.attr("href")}),e.preventDefault()},z=function(t){var n=$(this),r;gt(v.addHouse,"0"),r={Method:"AddHouse",Data:{SRC:" /buy/house/"+D.hfId+"/",HFID:D.hfId}},$.ajax({url:e+"ashx/Buy/New/MyNotes.ashx",type:"GET",dataType:"jsonp",data:"RequestPackage="+JSON.stringify(r),success:function(e,t,r){var i=parseInt(e.Status,10),s=parseInt(e.StatusCode,10),o="",u;if(i===-1||i===1&&s===5){k.showError();return}u=e.Data;switch(s){case 1:o="#lightbox-add-house-success";var a=$(o),f=parseInt(u.amount,10),l=parseInt(u.total,10),c=l-f>0?l-f:0;a.find(".amount").text(f),a.find(".remaining").text(c),a.find(".b-lightbox-hd .name").html(decodeURIComponent(u.MemberName)+"您好！");break;case 2:o="#lightbox-add-house-duplicate",$(o).find(".b-lightbox-hd .name").html(decodeURIComponent(u.MemberName)+"您好！");break;case 3:o="#lightbox-add-house-limit",$(o).find(".b-lightbox-hd .name").html(decodeURIComponent(u.MemberName)+"您好！");break;case 4:o="#lightbox-add-house-nonlogin"}n.CiRoBox({backdropclose:!0,click:!1,content:o,width:620})},error:function(e,t,n){k.showError()}}),t.preventDefault()},W=function(e){gt(v.addHouse,"1"),window.location.href=$(this).attr("href"),e.preventDefault()},X=function(t){var n=$(this),r;gt(v.notifyLowerPrice,"0"),r={Method:"GetLowPrice",Data:{SRC:" /buy/house/"+D.hfId+"/",HFID:D.hfId}},$.ajax({url:e+"ashx/Buy/New/MyNotes.ashx",type:"GET",dataType:"jsonp",data:"RequestPackage="+JSON.stringify(r),success:function(e,t,r){var i=parseInt(e.Status,10),s=parseInt(e.StatusCode,10),o="",u;if(i===-1||i===1&&s===5){k.showError();return}u=e.Data;switch(s){case 1:o="#lightbox-lower-price-success",$(o).find(".b-lightbox-hd .name").html(decodeURIComponent(u.MemberName)+"您好！");break;case 2:o="#lightbox-lower-price-duplicate",$(o).find(".b-lightbox-hd .name").html(decodeURIComponent(u.MemberName)+"您好！");break;case 3:o="#lightbox-lower-price-limit",$(o).find(".b-lightbox-hd .name").html(decodeURIComponent(u.MemberName)+"您好！");break;case 4:o="#lightbox-lower-price-nonlogin"}n.CiRoBox({backdropclose:!0,click:!1,content:o,width:620})},error:function(e,t,n){k.showError()}}),t.preventDefault()},V=function(e){gt(v.notifyLowerPrice,"1"),window.location.href=$(this).attr("href"),e.preventDefault()},J=function(t){var n=$(this),r;gt(v.addBuilding,"0"),r={Method:"AddBuilding",Data:{SRC:" /buy/house/"+D.buildingId+"/",BuildingID:D.buildingId}},$.ajax({url:e+"ashx/Buy/New/MyNotes.ashx",type:"GET",dataType:"jsonp",data:"RequestPackage="+JSON.stringify(r),success:function(e,t,r){var i=parseInt(e.Status,10),s=parseInt(e.StatusCode,10),o="",u;if(i===-1||i===1&&s===5){k.showError();return}u=e.Data;switch(s){case 1:o="#lightbox-add-building-success";var a=$(o),f=parseInt(u.amount,10),l=parseInt(u.total,10),c=l-f>0?l-f:0;a.find(".amount").text(f),a.find(".remaining").text(c),a.find(".b-lightbox-hd .name").html(decodeURIComponent(u.MemberName)+"您好！");break;case 2:o="#lightbox-add-building-duplicate",$(o).find(".b-lightbox-hd .name").html(decodeURIComponent(u.MemberName)+"您好！");break;case 3:o="#lightbox-add-building-limit",$(o).find(".b-lightbox-hd .name").html(decodeURIComponent(u.MemberName)+"您好！");break;case 4:o="#lightbox-add-building-nonlogin"}n.CiRoBox({backdropclose:!0,click:!1,content:o,width:620})},error:function(e,t,n){k.showError()}}),t.preventDefault()},K=function(e){gt(v.addBuilding,"1"),window.location.href=$(this).attr("href"),e.preventDefault()},Q=function(e){gt(v.notifyBuildingNewCase,"1"),window.location.href=$(this).attr("href"),e.preventDefault()},G=function(e){jQuery.fn.CiRoBoxClose&&jQuery.fn.CiRoBoxClose(),e.preventDefault()},Y=function(e){var t=$(e.currentTarget).closest(".m-choice");t.find('input[type="checkbox"]').prop("checked")?t.removeClass(o):t.addClass(o)},Z=function(e){T.find(".form-group-gender .m-choice.is-single").removeClass(o),$(this).closest(".m-choice").addClass(o);if(C){var t=T.find(".form-group-gender .m-choice.is-single .m-icon"),n=$(this).find(".m-icon");t.removeClass("m-icon-choice-single"),setTimeout(function(){t.addClass("m-icon-choice-single"),n.addClass("m-icon-choice-single")},0)}},et=function(e){$(this).closest(".m-choice").addClass(o);var t=T.find(".form-group-time .m-choice").not(".is-single");t.each(function(e,t){$(t).removeClass(o),$(t).find('input[type="checkbox"]').prop("checked",!1);if(C){var n=$(t).find(".m-icon");n.removeClass("m-icon-choice"),setTimeout(function(){n.addClass("m-icon-choice")},0)}})},tt=function(e){Y(e);var t=$("#reservation-radio-time").closest(".m-choice");t.removeClass(o),t.find('input[type="radio"]').prop("checked",!1);if(C){var n=t.find(".m-icon");n.removeClass("m-icon-choice-single"),setTimeout(function(){n.addClass("m-icon-choice-single")},0)}},nt=function(e){var t=T.find(".form-fieldset-extra-info");t.removeClass(f)},rt=function(e){var t=T.find('textarea[name="message"]'),n=t.closest(".m-form-group"),r=n.find(".m-form-help-block");n.removeClass(l),r.length||(r=$('<p class="m-form-help-block"></p>')),r.html("字數限制："+t.val().length+"/"+_).appendTo(n)},it=function(t){if(!$(this).find(".contact").hasClass("contact-incomplete"))return;$(".action-view-phone").find(".contact").removeClass("contact-incomplete");var n={Method:"Inquire",Data:{HFID:D.hfId}};$.ajax({url:e+"ashx/Buy/New/HousePhoneHit.ashx",type:"GET",dataType:"jsonp",data:"RequestPackage="+JSON.stringify(n),success:function(e,t,n){var r=parseInt(e.Status,10),i=parseInt(e.StatusCode,10),s=e.Data;if(r===-1||r===1&&(i===0||i===-1)){k.showError();return}s.HitID&&_dmq.push(["_setTransaction","0",s.HitID]);var o=wt(),u="",a="";o.utm_source?(u=D.hfId,o.utm_content&&(u=u+"_"+o.utm_content),u+="_TEL",a=o.utm_source):(u=D.hfId+"_TEL",a=window.location.host),St({transactionId:u,affiliation:a,skuCode:D.caseNo,productName:D.caseName,category:""})},error:function(e,t,n){k.showError()}}),t.preventDefault()},st=function(e){var t=$(this).attr("data-target");$(this).CiRoBox({backdropclose:!0,click:!1,content:t,width:620}),e.preventDefault()},ot=function(e){var t=$("#down-payment"),n=$("#loan-principal"),r=$("#loan-rate"),i=$("#loan-year"),s=t.val().replace(/[^0-9]+/gi,""),o=n.val().replace(/[^0-9]+/gi,""),u=r.val().replace(/[^0-9\.]+/gi,""),a=i.val().replace(/[^0-9]+/gi,""),f=0,c=$(this).attr("id"),h=t.closest(".m-form-group"),p=n.closest(".m-form-group"),d=r.closest(".m-form-group"),v;s=(parseInt(s,10)||0)*1e4,o=(parseInt(o,10)||0)*1e4,a=parseInt(a,10)||0,v='<p class="m-form-help-block">您輸入的金額已超過此房屋價格囉！請重新輸入正確金額。</p>';switch(c){case"down-payment":h.removeClass(l),h.find(".m-form-control-col p").remove(),o=M-s,s>M&&(h.addClass(l),h.find(".m-form-control-col").append($(v)));break;case"loan-principal":p.removeClass(l),p.find(".m-form-control-col p").remove(),s=M-o,o>M&&(p.addClass(l),p.find(".m-form-control-col").append($(v)));break;case"loan-rate":d.removeClass(l),d.find(".m-form-control-col p").remove(),parseFloat(u)>100&&(d.addClass(l),d.find(".m-form-control-col").append($('<p class="m-form-help-block">請勿輸入超過100%的利率唷！請重新輸入正確利率。</p>')))}t.val(parseInt(s/1e4,10)),n.val(parseInt(o/1e4,10)),r.val(u),i.val(a),f=parseInt(Ot(o,parseFloat(u),a),10),f=At(f.toString()),$("#monthly-payment").text(f),$("#monthly-payment-amount").text("$"+f)},ut=function(t){var n=$(this).closest("li"),r=$(this).attr("data-type");$.isEmptyObject(j["default"])||$.each(j["default"],function(e,t){Pt(t,!0)});if(n.hasClass(u))n.removeClass(u),j[r]&&Pt(j[r]);else{n.addClass(u);if(j[r]){Ht(j[r]);return}$.ajax({url:e+"ashx/Buy/GetPOI.ashx",type:"GET",dataType:"json",data:{POIType:r,Lng:D.lng,Lat:D.lat,Distance:500},success:function(e,t,n){if(!e.POI.length)return;j[r]=[],Dt({type:r,data:e.POI,markers:j[r]})},error:function(e,t,n){k.showError()}})}t.preventDefault()},at=function(e){var t=$(this).closest("li").data("poi"),n=new google.maps.LatLng(t.lat,t.lng),r=[];I&&clearTimeout(I),I=setTimeout(function(){F?(F.setPosition(n),F.setIcon(g[t.type]),F.setMap(H)):F=new google.maps.Marker({position:n,map:H,icon:g[t.type],title:t.name}),r=['<div class="map-infowindow">','<h4 class="heading">'+t.name+"</h4>","</div>"],B?(B.close(),B.setContent(r.join(""))):B=new google.maps.InfoWindow({content:r.join(""),maxWidth:250}),B.open(H,F)},200)},ft=function(e){I&&clearTimeout(I),F&&F.setMap(null),B&&B.close()},lt=function(t){if(!$(this).hasClass(p))return;var n={Method:"Inquire",Data:{HFID:D.hfId}};$.ajax({url:e+"ashx/Buy/New/DetailObjView.ashx",type:"GET",dataType:"jsonp",data:"RequestPackage="+JSON.stringify(n),success:function(e,t,n){var r=parseInt(e.Status,10),i=parseInt(e.StatusCode,10),s=e.Data;if(r===-1||r===1&&i===-1){k.showError();return}var o=$(".m-paging-btn-prev"),u=$(".m-paging-btn-next");$.each(e.Data,function(e,t){t=$.parseJSON(t);var n=e==="Prev"?o:u,r=n.find(".m-paging-main"),i,s=[];$.isEmptyObject(t)?(r.html("無推薦物件"),n.css("cursor","default"),n.removeClass(p).addClass(d)):(i=$('<div class="m-paging-thumb"></div>'),n.attr("href","/buy/house/"+t.HFID),s=['<div class="m-paging-info">','<h4 class="m-paging-heading"><em>'+decodeURIComponent(t.Address)+"</em>"+t.RegArea+"坪</h4>",'<div class="m-paging-minor">'+decodeURIComponent(t.Room)+"</div>",'<div class="m-paging-major"><em>'+t.Price+"</em>萬</div>","</div>"],vt(t.Pic01,function(e){$(e).appendTo(i),r.html(""),r.append(i).append($(s.join(""))),n.removeClass(p)}))})},error:function(e,t,n){k.showError()}})},vt=function(e,t){var n=new Image;n.onload=function(){t&&t(n)},n.onerror=function(){PicFilter(this,0),t&&t(n)},n.src=e},mt=function(e){if(!window.sessionStorage)return;var t=window.sessionStorage.getItem(e)?window.sessionStorage.getItem(e):"{}",n=$.isNumeric($.parseJSON(t))?{}:$.parseJSON(t),r=m+D.hfId;return parseInt(n[r],10)},gt=function(e,t){if(!window.sessionStorage)return;var n=window.sessionStorage.getItem(e)?window.sessionStorage.getItem(e):"{}",r=$.isNumeric($.parseJSON(n))?{}:$.parseJSON(n),i=m+D.hfId;r[i]=t,window.sessionStorage.setItem(e,JSON.stringify(r))},yt=function(){var e=$(this).scrollTop(),t=S.length?S:x;if(e>=L&&t.length){var n=e-b.offset().top+A;n+w.height()>=t.position().top&&(n=t.position().top-w.height()),y.css("top",n)}else y.css("top",A)},kt=function(t){var n=T.find('input[name="email"]'),r=T.find(".form-fieldset-sign-up"),i;i={Method:"Inquire",Data:{Email:encodeURIComponent(n.val())}},$.ajax({url:e+"ashx/Buy/New/QueryMember.ashx",type:"GET",dataType:"jsonp",data:"RequestPackage="+JSON.stringify(i),success:function(e,t,n){var i=parseInt(e.Status,10),s=parseInt(e.StatusCode,10);if(i===-1||i===1&&s===0){k.showError();return}s===1?r.removeClass(f):s===2&&r.addClass(f)},error:function(e,t,n){k.showError()}})},Lt=function(t){gt(v.notifyBuildingNewCase,"0");var n={Method:"AddBuildingNewCase",Data:{BuildingID:D.buildingId}};$.ajax({url:e+"ashx/Buy/New/MyNotes.ashx",type:"GET",dataType:"jsonp",data:"RequestPackage="+JSON.stringify(n),success:function(e,n,r){var i=parseInt(e.Status,10),s=parseInt(e.StatusCode,10),o="",u;if(i===-1||i===1&&s===5){k.showError();return}u=e.Data;switch(s){case 1:o="#lightbox-notify-building-newcase-success",$(o).find(".b-lightbox-hd .name").html(decodeURIComponent(u.MemberName)+"您好！");break;case 2:o="#lightbox-notify-building-newcase-duplicate",$(o).find(".b-lightbox-hd .name").html(decodeURIComponent(u.MemberName)+"您好！");break;case 3:o="#lightbox-notify-building-newcase-limit",$(o).find(".b-lightbox-hd .name").html(decodeURIComponent(u.MemberName)+"您好！");break;case 4:o="#lightbox-notify-building-newcase-nonlogin"}t.CiRoBox({backdropclose:!0,click:!1,content:o,width:620})},error:function(e,t,n){k.showError()}})},At=function(e){return e.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},Ot=function(e,t,n){var r=0,i=0,s=0,o=0;return e>0&&t>0&&n>0&&(r=t/100/12,i=n*12,s=Math.pow(1+r,i)*r/(Math.pow(1+r,i)-1),o=e*s),o},Mt=function(){var t={Method:"Inquire",Data:{HFID:D.hfId}};$.ajax({url:e+"ashx/Buy/new/GetLivingNear.ashx",type:"GET",dataType:"jsonp",data:"RequestPackage="+JSON.stringify(t),success:function(e,t,n){var r=parseInt(e.Status,10),i=parseInt(e.StatusCode,10);if(r===-1||r===1&&i===0){k.showError();return}_t(e.Data.near)},error:function(e,t,n){k.showError()}})},_t=function(e){var t=S.find(".info");t.html(""),$.each(e,function(e,n){var r,i;r={name:decodeURIComponent(n.Name),distance:n.Distance,lat:parseFloat(n.Lat,10),lng:parseFloat(n.Lng,10),type:n.TypeName},$("<li></li>").data("poi",r).html('<a href="javascript:;">到 <em title="'+r.name+'">'+r.name+"</em> "+r.distance+"公尺</a>").appendTo(t)}),t.find("li a").hover(at,ft)},Dt=function(e){$.each(e.data,function(t,n){var r=parseFloat(n.Lat,10),i=parseFloat(n.Lng,10),s;B||(B=new google.maps.InfoWindow({content:"",maxWidth:250})),s=new google.maps.Marker({position:new google.maps.LatLng(r,i),map:H,icon:g[e.type],title:decodeURIComponent(n.Name)+"("+decodeURIComponent(n.Title)+")"}),google.maps.event.addListener(s,"click",function(e){var t=['<div class="map-infowindow">','<h4 class="heading">'+decodeURIComponent(n.Name)+"("+decodeURIComponent(n.Title)+")"+"</h4>","<p>"+decodeURIComponent(n.Address)+"</p>","</div>"];B.setContent(t.join("")),B.open(H,s)}),e.markers.push(s)})},Pt=function(e,t){if(!e.length)return;for(var n=e.length-1;n>=0;n--){var r=e[n];r.setMap(null),t&&e.pop()}},Ht=function(e){$.each(e,function(e,t){t.setMap(H)})},Bt=function(t){var n={Method:"Inquire",Data:{Page:1,SearchMode:5,HFID:D.hfId}};$.ajax({url:e+"ashx/Buy/New/GetBuyList.ashx",type:"GET",dataType:"jsonp",data:"RequestPackage="+JSON.stringify(n),success:function(n,r,i){var s=parseInt(n.Status,10),o=parseInt(n.StatusCode,10);if(s===-1||s===1&&o===0){k.showError();return}var u=$.parseJSON(n.Data.ListObjects),a=[],l=x.find(".m-thumbnail-bd");if(!u.length)return;l.html(""),$.each(u,function(t,n){a.push('<section class="m-thumbnail-item">'),a.push('<a class="ga_click_trace" href="'+e+"buy/house/"+n.HFID+'" target="_blank" ga_cat="detail_more_house" ga_event="click" ga_label="detail_more_house_'+(t+1)+'">'),a.push('<div class="m-thumbnail-item-hd m-thumbnail-figure">'),a.push('<figure class="m-thumbnail-figure-bd b-middleSet">'),a.push('<div class="'+h+'" data-alt="'+n.CaseName+'" data-src="'+n.CoverPic+'"></div>'),a.push("</figure>"),a.push("</div>"),a.push('<div class="m-thumbnail-item-bd">'),a.push('<h2 class="casename">'+n.CaseName+"</h2>"),a.push('<div class="price">'),n.LastPrice&&a.push('<span class="original-price"><em class="number">'+n.LastPrice+'</em><em class="postfix">萬</em></span>'),a.push('<span class="discount-price"><em class="number">'+n.Price+'</em><em class="postfix">萬</em></span>'),a.push("</div>"),a.push("</div>"),a.push("</a>"),a.push("</section>")}),l.html(a.join("")),x.removeClass(f),$.isFunction(t)&&t()},error:function(e,t,n){k.showError()}})},jt=function(){if(x.hasClass(f))return;var e=x.find(".m-thumbnail-bd");e.find("."+h).each(function(e,t){var n=$(t);vt(n.attr("data-src"),function(e){e.alt=n.attr("data-alt"),n.fadeIn(1e3,function(){n.replaceWith($(e))})})})},bt=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),i=e.getHours(),s=e.getMinutes(),o=e.getSeconds(),u=[],a="000"+Math.floor(Math.random()*1e3).toString();return u=[t,n>=10?n:"0"+n,r>=10?r:"0"+r,i>=10?i:"0"+i,s>=10?s:"0"+s,o>=10?o:"0"+o],u.join("")+a.substring(a.length,a.length-3)},wt=function(){var e={};if(window.location.href.indexOf("?")!==-1){var t=window.location.href.split("?")[1].split("&");$.each(t,function(t,n){var r=n.split("=");e[r[0]]=r[1]})}return e},Et=function(){if(typeof DoObjectTrack=="undefined"){setTimeout(arguments.callee,100);return}var e="/"+encodeURIComponent("買屋"),t=0,n="",r=[];D.wmRefUrl?(n=D.wmRefUrl,t=0):(n=document.referrer?document.referrer:window.location.href,t=n==="http://buy.housefun.com.tw/"||n.indexOf(e)!==-1?0:1),r.push([1,"3"]),r.push([2,t]),r.push([3,"1"]),r.push([4,D.caseId]),r.push([5,n]),DoObjectTrack(r)},St=function(e){typeof dataLayer!="undefined"&&dataLayer.push({transactionId:e.transactionId,transactionAffiliation:e.affiliation,transactionTotal:1,transactionProducts:[{sku:e.skuCode,name:e.productName,category:e.category,price:1,quantity:1}],event:"trackTrans"})},xt=function(e,t){var n=[];n.push([1,bt()]),n.push([2,e]),n.push([3,"HF_買屋物件明細頁"]),n.push([4,t]),n.push([5,D.caseId]),DoMessage(n)},Tt=function(){var e="我在好房HouseFun看見物件請與我聯絡，謝謝。";T.find('input[type="text"], input[type="password"]').val(""),T.find('textarea[name="message"]').val(e),T.find(".m-choice").removeClass(u),T.find(".form-group-gender .m-choice.is-single").eq(0).addClass(u),T.find(".form-group-time .m-choice").eq(0).addClass(u),T.find(".m-form-group").removeClass(l),T.find(".m-form-help-block").html(""),T.find(".form-group-message").append($('<p class="m-form-help-block">字數限制：'+e.length+"/"+_+"</p>")),T.find(".form-fieldset-sign-up").addClass(f),T.find(".form-container-password").addClass(f),T.find("fieldset").prop("disbled",!1),T.find(".m-button").prop("disabled",!1),T.find(".action-submit").prop("disabled",!1).removeClass(c)},Nt=function(){var t={Method:"Inquire"};$.ajax({url:e+"ashx/Buy/New/QueryLoginStatus.ashx",type:"GET",dataType:"jsonp",data:"RequestPackage="+JSON.stringify(t),success:function(e,t,n){if(parseInt(e.Status,10)===-1)return;var r=parseInt(e.StatusCode,10);if(r===0||r===-1)k.showError();else if(r===1){P=!0;var i=e.Data,s=i.Sexual?i.Sexual:"1";T.find('input[name="last_name"]').val(decodeURIComponent(i.UserFName)),T.find('input[name="first_name"]').val(decodeURIComponent(i.UserLName)),T.find('input[name="email"]').val(i.ContactEmail),T.find('input[name="phone"]').val(i.MobilPhoneNumber),T.find(".form-group-gender .m-choice.is-single").removeClass(u),T.find('.form-group-gender .m-choice.is-single input[name="gender"]').prop("checked",!1),T.find(".form-group-gender .m-choice.is-single").each(function(e,t){var n=$(t).find('input[name="gender"]');n.val()===s&&($(t).addClass(u),n.prop("checked",!0))})}},error:function(e,t,n){k.showError()}})},ht=function(){O=$("#profile-name").html(),_=T.find('textarea[name="message"]').attr("maxLength"),T.find("input[placeholder], textarea").placeholder(),Nt(),T.find('input[name="email"]').on("focus",nt),T.find(".action-submit").on("click",nt),T.find(".form-group-gender .m-choice-btn").on("click",Z),T.find(".form-group-time .m-choice.is-single .m-choice-btn").on("click",et),T.find('.form-group-time .m-choice:not(".is-single") .m-choice-btn').on("click",tt),T.find(".form-group-sign-up .m-choice-btn").on("click",function(e){Y(e);var t=T.find(".form-container-password");$(this).closest(".m-choice").find('input[type="checkbox"]').prop("checked")?t.addClass(f):t.removeClass(f)}),T.find(".form-group-agreement .m-choice-btn").on("click",Y),T.find('.form-group-message textarea[name="message"]').on("keyup",rt),$("#form1").validate({onkeyup:!1,rules:{last_name:{nameRequired:".form-control-first-name",nameEachRequired:!0},first_name:{nameRequired:".form-control-last-name",nameEachRequired:!0},email:{required:!0,emailValid:!0},phone:{required:!0,digits:!0,rangelength:[9,10]},time:{timeRequired:[$("#reservation-radio-time"),T.find('input[name="time"]')]},message:{required:!0},agreement:{required:!0},password:{required:function(e){return $("#reservation-checkbox-sign-up:checked").length>0},rangelength:[6,20]},confirm_pwd:{required:function(e){return $("#reservation-checkbox-sign-up:checked").length>0},rangelength:[6,20],equalTo:T.find('input[name="password"]')}},messages:{last_name:{nameRequired:n.name_required,nameEachRequired:n.last_name_required},first_name:{nameRequired:n.name_required,nameEachRequired:n.first_name_required},email:{required:n.email_required,emailValid:n.email_valid},phone:{required:n.phone_required,digits:n.phone_valid,rangelength:n.phone_length},time:{timeRequired:n.contact_time_required},message:{required:n.message_required},agreement:{required:n.agreement_required},password:{required:n.password_required,rangelength:n.password_length},confirm_pwd:{required:n.password_required,rangelength:n.password_length,equalTo:n.password_equal}},onclick:function(e,t){$(e).valid()},onfocusout:function(e,t){$(e).valid()},invalidHandler:function(e,t){},submitHandler:function(t){N.find(".b-loading-bd").css("height",T.outerHeight()),N.removeClass(f),T.find("fieldset").prop("disbled",!0),T.find(".m-button").prop("disabled",!0);var n=T.find('input[name="choice_time"]:checked'),r=T.find('input[name="time"]:checked'),i=T.find('input[name="sign_up"]:checked'),s=[],o=$.trim(T.find('input[name="email"]').val()),u=$.trim(T.find('input[name="phone"]').val()),a={};return n.length?s.push(n.val()):r.each(function(e,t){s.push($(t).val())}),a={Method:"Inquire",Data:{FirstName:encodeURIComponent($.trim(T.find('input[name="last_name"]').val())),LastName:encodeURIComponent($.trim(T.find('input[name="first_name"]').val())),Sexual:T.find('input[name="gender"]:checked').val(),Email:encodeURIComponent(o),PhoneNumber:u,BecomeMember:i.length?"Y":"N",FreeTime:s.join(","),Memo:encodeURIComponent($.trim(T.find('textarea[name="message"]').val())),Password:i.length?T.find('input[name="password"]').val():"",HFID:D.hfId,CaseID:D.caseId,MessageType:D.messageType,ShopID:D.shopId,WebMaxMsgCode:bt(),AssignBuilding:encodeURIComponent(D.assignBuilding),County:encodeURIComponent(D.county),District:encodeURIComponent(D.district),Road:encodeURIComponent(D.road)}},$.ajax({url:e+"ashx/Buy/New/LeaveMessage.ashx",type:"GET",dataType:"jsonp",data:"RequestPackage="+JSON.stringify(a),beforeSend:function(e,t){T.find(".action-submit").prop("disabled",!0).addClass(c)},success:function(e,t,n){N.addClass(f),Tt();if(parseInt(e.Status,10)===-1){k.showError();return}var r=parseInt(e.StatusCode,10),i=e.Data;if(r===0)k.showError();else if(r===1){e.Data.MessageID&&_dmq.push(["_setTransaction","1","01-"+i.MessageID]),xt(o,u);var s=wt(),a=D.hfId,l="",c="";s.utm_source?(s.utm_content&&(a=a+"_"+s.utm_content),l=c=s.utm_source):l=window.location.host,St({transactionId:a,affiliation:l,skuCode:c,productName:D.caseName,category:D.messageType}),alert("留言成功! 謝謝您! 我們已將您的留言傳送給【"+O+"】，如聯繫上有任何問體，請致電客服中心，謝謝。好房網客服專線:412-8668 (手機直撥請加02)")}},error:function(e,t,n){N.addClass(f),Tt(),k.showError()}}),!1},highlight:function(e,t,n){if($(e).closest(".m-form").attr("id")!=="reservation-form")return;$(e).closest(".m-form-group").addClass(l)},unhighlight:function(e,t,n){if($(e).closest(".m-form").attr("id")!=="reservation-form")return;$(e).closest(".m-form-group").removeClass(l),$(e).closest(".m-form-group").find(".m-form-help-block").remove(),!P&&$(e).attr("name")==="email"&&kt(),rt()},errorPlacement:function(e,t){if($(t).closest(".m-form").attr("id")!=="reservation-form")return;t.closest(".m-form-group").find(".m-form-help-block").remove();var n=$('<p class="m-form-help-block"></p>').append(e);t.closest(".m-form-group").append(n)}})},pt=function(){M=(parseInt($("#total-amount").text().replace(",",""),10)||0)*1e4;var e=M*.3,t=M-e;$("#down-payment").val(parseInt(e/1e4,10)),$("#loan-principal").val(parseInt(t/1e4,10)),$("#loan-rate").val(2),$("#loan-year").val(20),$("#down-payment, #loan-principal, #loan-rate, #loan-year").on("keyup",ot)},dt=function(){var e=document.getElementById("map-canvas"),t=new google.maps.LatLng(D.lat,D.lng),n,r,i,s;n=[{featureType:"administrative",elementType:"all",stylers:[{saturation:0}]},{featureType:"administrative.country",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"administrative.province",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"landscape",elementType:"all",stylers:[{saturation:-10}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"all",stylers:[{saturation:-10},{lightness:30},{visibility:"simplified"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100}]},{featureType:"road.highway",elementType:"geometry",stylers:[{saturation:0},{hue:"#5EAB1F"},{lightness:0}]},{featureType:"road.highway",elementType:"label",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"all",stylers:[{saturation:-100},{lightness:20}]},{featureType:"road.arterial",elementType:"label",stylers:[{visibility:"on"}]},{featureType:"road.local",elementType:"label",stylers:[{visibility:"on"}]},{featureType:"transit",elementType:"all",stylers:[{saturation:-100}]},{featureType:"water",elementType:"all",stylers:[{hue:"#0089CF"},{saturation:-50},{lightness:30}]},{featureType:"administrative.land_parcel",elementType:"all",stylers:[{visibility:"on"}]}],r={zoom:17,maxZoom:19,minZoom:13,center:t,mapTypeId:google.maps.MapTypeId.ROADMAP,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL},scrollwheel:!1,styles:n},H=new google.maps.Map(e,r),s=H.getStreetView(),s.setPosition(H.getCenter());if(D.isShift){var o=new google.maps.Circle({strokeWeight:0,fillColor:"#ff9933",fillOpacity:.35,map:H,center:t,radius:100});google.maps.event.addListener(o,"mouseover",function(e){$(H.getDiv()).attr("title","物件位於此範圍內")}),google.maps.event.addListener(o,"mouseout",function(e){$(H.getDiv()).attr("title","")})}else i=new google.maps.Marker({position:t,map:H,icon:g.current,title:"目前物件位置"});var u=$('<div class="map-control"></div>').html('<a class="btn" draggable="false" href="javascript:;" title="街景">街景</a>');u.on("click",function(e){s.setVisible(!0),e.preventDefault()}),H.controls[google.maps.ControlPosition.TOP_RIGHT].push(u.get(0)),google.maps.event.addListener(H,"dragend",function(){s.setPosition(H.getCenter())}),google.maps.event.addListener(H,"maptypeid_changed",function(){var e=H.getMapTypeId();switch(e){case google.maps.MapTypeId.HYBRID:gtm_event_track("detail_map","detail_map_function_click","detail_map_function_Satellite imagery");break;case google.maps.MapTypeId.ROADMAP:gtm_event_track("detail_map","detail_map_function_click","detail_map_function_map");break;case google.maps.MapTypeId.TERRAIN:gtm_event_track("detail_map","detail_map_function_click","detail_map_function_landscape")}}),google.maps.event.addListener(s,"visible_changed",function(){s.getVisible()&&gtm_event_track("detail_map","detail_map_function_click","detail_map_function_Street View")}),Mt()},ct=function(){window.HF.tools.logResults(),D={hfId:$("#query-hf-id").val(),buildingId:$("#query-building-id").val(),caseId:$("#query-case-id").val(),messageType:$("#query-message-type").val(),shopId:$("#query-shop-id").val(),assignBuilding:$("#query-assign-building").val(),county:$("#query-county").val(),district:$("#query-district").val(),road:$("#query-road").val(),caseNo:$("#query-case-no").val(),caseName:$("#query-case-name").val(),isShift:parseInt($("#query-XYShift").val(),10),lng:parseFloat($("#query-lng").val(),10),lat:parseFloat($("#query-lat").val(),10),wmRefUrl:$("#query-wm-ref-url").val()};if(!D.hfId)return;Et(),L=y.offset().top,A=y.position().top,yt(),ht(),pt();if(S.length){var e={callback:dt};typeof gmap_client_id!="undefined"&&gmap_client_id&&$.extend({},e,{other_params:"client="+gmap_client_id+"&sensor=false"}),google.load("maps","3.9",e),S.on("click",".tabs > li > a",ut)}$(window).on("resize scroll",function(e){yt(),$(this).scrollTop()>=E.offset().top-400&&jt()}),$(window).scrollTop()>=E.offset().top-400?Bt(jt):Bt(),$("#action-share").on("click",q),$("#action-forward").on("click",R),$("#action-report").on("click",U),$("#action-add-house").on("click",z),$("#action-lower-price").on("click",X),$("#action-add-building").on("click",J),$("#lightbox-add-house-nonlogin").find(".action-sign-in, .action-sign-up").on("click",W),$("#lightbox-lower-price-nonlogin").find(".action-sign-in, .action-sign-up").on("click",V),$("#lightbox-add-building-nonlogin").find(".action-sign-in, .action-sign-up").on("click",K),$("#lightbox-notify-building-newcase-nonlogin").find(".action-sign-in, .action-sign-up",Q),$("#lightbox-add-house-success").find(".action-notify-lower-price").on("click",function(e){$("#action-lower-price").trigger("click"),e.preventDefault()}),$("#lightbox-add-building-success").find(".action-notify-building-newcase").on("click",function(e){Lt($("#action-add-building")),e.preventDefault()}),$("#lightbox-add-house-success").find(".action-view").on("click",G),$("#lightbox-lower-price-success").find(".action-view").on("click",G),$("#lightbox-add-building-success").find(".action-view").on("click",G),$("#lightbox-notify-building-newcase-success").find(".action-view").on("click",G),$("#lightbox-notify-building-newcase-duplicate").find(".action-view").on("click",G),mt(v.addHouse)&&$("#action-add-house").trigger("click"),mt(v.notifyLowerPrice)&&$("#action-lower-price").trigger("click"),mt(v.addBuilding)&&$("#action-add-building").trigger("click"),mt(v.notifyBuildingNewCase)&&$("#lightbox-add-building-success").find(".action-notify-building-newcase").trigger("click"),$(".action-view-phone").on("click",it),$("#badge-list").on("click","li > a",st),$(".m-icon-question-circle").each(function(e,t){$(t).mtooltip({title:"電話不通 ？",content:"部分節費系統無法撥打本服務專線，請改用其他市話或其他電信業者（如：中華電信、遠傳、台灣大哥大、亞太、威寶）撥打。",container:".detail-content"})}),$("#action-land-building").mpopover({title:"謄本資料",content:$("#popover-land-building").find(".popover-content"),container:".detail-content",placement:"upper-left"}),$("#action-caculation").mpopover({title:"簡易房貸試算公式",content:$("#popover-caculation").find(".popover-content"),container:".detail-content",placement:"upper-left"}),$(".m-paging-btn-prev, .m-paging-btn-next").on("mouseenter",lt)},ct()}),define("d",function(){}),$(function(){var e,t,n=function(){e===t&&alert("lol")}}),define("me",function(){});